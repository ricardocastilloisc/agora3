(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{Q4H4:function(e,i,o){"use strict";o.r(i),o.d(i,"VideoModule",function(){return u});var t=o("ofXK"),n=o("tyNb");function a(e,i,o,t){return new(o||(o=Promise))(function(n,a){function r(e){try{s(t.next(e))}catch(i){a(i)}}function l(e){try{s(t.throw(e))}catch(i){a(i)}}function s(e){var i;e.done?n(e.value):(i=e.value,i instanceof o?i:new o(function(e){e(i)})).then(r,l)}s((t=t.apply(e,i||[])).next())})}var r,l,s=o("fXoL");const c=[{path:"",component:(()=>{class e{constructor(){this.rtc={client:AgoraRTC.createClient({mode:"rtc",codec:"vp8"}),joined:!1,published:!1,localStream:null,remoteStreams:[],params:{uid:""}},console.log("agora sdk version: "+AgoraRTC.VERSION+" compatible: "+AgoraRTC.checkSystemRequirements())}ngAfterViewInit(){this.getdevices()}getdevices(){return a(this,void 0,void 0,function*(){new Promise((e,i)=>{AgoraRTC.checkSystemRequirements()?$("#compatibility").html("AgoraRTC supported."):$("#compatibility").html("AgoraRTC not fully supported and some functions may be lost."),AgoraRTC.getDevices(i=>{let o="",t="";i.forEach(e=>{"audioinput"===e.kind&&(t+="<option value="+e.deviceId+">"+e.label+"</option>"),"videoinput"===e.kind&&(o+="<option value="+e.deviceId+">"+e.label+"</option>")}),$("#cameraId").html(o),$("#microphoneId").html(t),e()})})})}ngOnInit(){}handleEvents(e){e.client.on("error",e=>{console.log(e)}),e.client.on("peer-leave",i=>{var o=i.uid;console.log("id",i);let t=e.remoteStreams.filter(e=>o!==e.getId()),n=e.remoteStreams.find(e=>o===e.getId());n&&n.isPlaying()&&n.stop(),e.remoteStreams=t,o!==e.params.uid&&this.removeView(o),console.log("peer-leave",o)}),e.client.on("stream-published",e=>{console.log("stream-published")}),e.client.on("stream-added",i=>{var o=i.stream,t=o.getId();t!==e.params.uid&&e.client.subscribe(o,e=>{console.log("stream subscribe failed",e)}),console.log("stream-added remote-uid: ",t)}),e.client.on("stream-subscribed",i=>{var o=i.stream,t=o.getId();e.remoteStreams.push(o),this.addView(t),o.play("remote_video_"+t),console.log("stream-subscribed remote-uid: ",t)}),e.client.on("stream-removed",i=>{var o=i.stream,t=o.getId();o.isPlaying()&&o.stop(),e.remoteStreams=e.remoteStreams.filter(e=>e.getId()!==t),this.removeView(t),console.log("stream-removed remote-uid: ",t)}),e.client.on("onTokenPrivilegeWillExpire",()=>{console.log("onTokenPrivilegeWillExpire")}),e.client.on("onTokenPrivilegeDidExpire",()=>{console.log("onTokenPrivilegeDidExpire")})}addView(e,i=!0){console.log("este es el creador de addViwe"),$("#"+e)[0]||($("<div/>",{id:"remote_video_panel_"+e,class:"video-view"}).appendTo("#video"),$("<div/>",{id:"remote_video_"+e,class:"video-placeholder"}).appendTo("#remote_video_panel_"+e),$("<div/>",{id:"remote_video_info_"+e,class:"video-profile "+(i?"":"hide")}).appendTo("#remote_video_panel_"+e),$("<div/>",{id:"video_autoplay_"+e,class:"autoplay-fallback hide"}).appendTo("#remote_video_panel_"+e))}removeView(e){$("#remote_video_panel_"+e)[0]&&$("#remote_video_panel_"+e).remove()}leaveAction(){this.rtc.joined?this.leave(this.rtc):console.log("You are not in channel")}shareEnd(){try{r&&r.unpublish(l),l&&l.close(),r&&r.leave(()=>{console.log("Share client succeed to leave.")},()=>{console.log("Share client failed to leave.")})}finally{r=null,l=null}}leave(e){e.client.leave(()=>{e.localStream.isPlaying()&&e.localStream.stop(),e.localStream.close();for(let t=0;t<e.remoteStreams.length;t++){var i=e.remoteStreams.shift(),o=i.getId();i.isPlaying()&&i.stop(),this.removeView(o)}e.localStream=null,e.remoteStreams=[],e.client=null,console.log("client leaves channel success"),e.published=!1,e.joined=!1,console.log("leave success")},e=>{console.log("channel leave failed"),console.log("leave success"),console.error(e)})}shareStart(){r=AgoraRTC.createClient({mode:"rtc",codec:"vp8"}),this.clientInit(r,this.optionsShared).then(e=>a(this,void 0,void 0,function*(){(l=this.streamInit(e,{streamID:e,audio:!1,video:!1,screen:!0})).init(()=>{l.on("stopScreenSharing",()=>{this.shareEnd(),console.log("Stop Screen Sharing at"+new Date)}),r.publish(l,e=>{console.log("Publish share stream error: "+e),console.log("getUserMedia failed",e)})},e=>{console.log(e)})}))}streamInit(e,i){return AgoraRTC.createStream(i)}clientInit(e,i){return new Promise((o,t)=>{e.init(null==i?void 0:i.appID,()=>{e.join(null==i?void 0:i.token,null==i?void 0:i.channel,""==(null==i?void 0:i.uid)?+i.uid:null,e=>{o(e)},e=>{t(e)})})})}join(){if(this.rtc.joined)return void console.log("Your already joined");this.rtc.client=AgoraRTC.createClient({mode:"rtc",codec:"vp8"});let e={mode:"rtc",codec:"vp8",appID:"9e6a9b0a859c4a7e9efe79b797c80b98",channel:"test",uid:"",microphoneId:$("#microphoneId").val(),cameraId:$("#cameraId").val(),token:"0069e6a9b0a859c4a7e9efe79b797c80b98IAA/poy70O2n0034YyINqZvOE/cBvm8Y8vkiXmywSAqvUAx+f9gAAAAAEABwjq6PVwIiYAEAAQBXAiJg"};this.options=e,this.optionsShared=Object.assign({},this.options),this.optionsShared.uid=null,this.rtc.params=e,this.handleEvents(this.rtc),this.clientInit(this.rtc.client,this.options).then(i=>{this.rtc.joined=!0,this.rtc.params.uid=i;let o=this.streamInit(i,{streamID:this.rtc.params.uid,audio:!0,video:!0,screen:!1,microphoneId:e.microphoneId,cameraId:e.cameraId});this.rtc.localStream=o,o.init(()=>{console.log("init local stream success"),console.log("evento local_stream"),o.play("local_stream"),this.rtc.client.publish(o,e=>{console.error(e)}),this.rtc.published=!0},e=>{console.log("stream init failed, please open console see more detail"),console.error("init local stream failed ",e)})})}ActionEnableDisableVideo(){this.EnableDisableVideo(this.rtc.localStream)}EnableDisableVideo(e){e.isVideoOn()?e.disableVideo():e.enableVideo()}ActionEnableDisableAudio(){this.EnableDisableAudio(this.rtc.localStream)}EnableDisableAudio(e){e.isAudioOn()?e.disableAudio():e.enableAudio()}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=s.Bb({type:e,selectors:[["app-video"]],decls:43,vars:0,consts:[[1,"navbar-fixed"],[1,"agora-navbar"],[1,"nav-wrapper","agora-primary-bg","valign-wrapper"],[1,"left-align"],["id","form",1,"row","col","l12","s12"],[1,"row","container","col","l12","s12"],[1,"col",2,"min-width","433px","max-width","443px"],[1,"card",2,"margin-top","0px","margin-bottom","0px"],[1,"row","card-content",2,"margin-bottom","0px"],[1,"row",2,"margin","0"],[1,"col","s12"],["id","join",1,"btn","btn-raised","btn-primary","waves-effect","waves-light",3,"click"],["id","leave",1,"btn","btn-raised","btn-primary","waves-effect","waves-light",3,"click"],["id","EnableDisableVideo",1,"btn","btn-raised","btn-primary","waves-effect","waves-light",3,"click"],["id","EnableDisableAudio",1,"btn","btn-raised","btn-primary","waves-effect","waves-light",3,"click"],["id","ShareScreen",1,"btn","btn-raised","btn-primary","waves-effect","waves-light",3,"click"],[1,"col","s7"],["id","video",1,"video-grid"],[1,"video-view"],["id","local_stream",1,"video-placeholder"],["id","local_video_info",1,"video-profile","hide"],["id","video_autoplay_local",1,"autoplay-fallback","hide"],[1,"input-field"],["for","cameraId",1,"active"],["name","cameraId","id","cameraId"],["for","microphoneId",1,"active"],["name","microphoneId","id","microphoneId"]],template:function(e,i){1&e&&(s.Kb(0,"div",0),s.Kb(1,"nav",1),s.Kb(2,"div",2),s.Kb(3,"h5",3),s.Vb(4,"Libreria modificada para que funcione en angular "),s.Jb(),s.Kb(5,"h5",3),s.Vb(6,"\xa9 Ricardo Orlando Castillo Olivera"),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Kb(7,"div",4),s.Kb(8,"div",5),s.Kb(9,"div",6),s.Kb(10,"div",7),s.Kb(11,"div",8),s.Kb(12,"div",9),s.Kb(13,"div",10),s.Kb(14,"button",11),s.Qb("click",function(){return i.join()}),s.Vb(15,"JOIN"),s.Jb(),s.Kb(16,"button",12),s.Qb("click",function(){return i.leaveAction()}),s.Vb(17,"LEAVE"),s.Jb(),s.Kb(18,"button",13),s.Qb("click",function(){return i.ActionEnableDisableVideo()}),s.Vb(19,"Enable/Disable Video"),s.Jb(),s.Kb(20,"button",14),s.Qb("click",function(){return i.ActionEnableDisableAudio()}),s.Vb(21,"Enable/Disable Audio"),s.Jb(),s.Kb(22,"button",15),s.Qb("click",function(){return i.shareStart()}),s.Vb(23,"Share Screen"),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Kb(24,"div",16),s.Kb(25,"div",17),s.Kb(26,"div",18),s.Ib(27,"div",19),s.Ib(28,"div",20),s.Ib(29,"div",21),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Kb(30,"div",5),s.Kb(31,"div",6),s.Kb(32,"div",7),s.Kb(33,"div",8),s.Kb(34,"div",10),s.Kb(35,"div",22),s.Kb(36,"label",23),s.Vb(37,"CAMERA"),s.Jb(),s.Ib(38,"select",24),s.Jb(),s.Kb(39,"div"),s.Kb(40,"label",25),s.Vb(41,"MICROPHONE"),s.Jb(),s.Ib(42,"select",26),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb(),s.Jb())},styles:[""]}),e})()}];let d=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(i){return new(i||e)},imports:[[n.a.forChild(c)],n.a]}),e})();o("HDdC"),o("DH7j"),o("lJxs"),o("XoHu"),o("Cfvw");let b=(()=>{class e{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=s.Db({token:e,factory:e.\u0275fac}),e})(),m=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(i){return new(i||e)}}),e})(),v=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(i){return new(i||e)},providers:[b],imports:[m]}),e})(),u=(()=>{class e{}return e.\u0275mod=s.Fb({type:e}),e.\u0275inj=s.Eb({factory:function(i){return new(i||e)},imports:[[t.b,d,v]]}),e})()}}]);